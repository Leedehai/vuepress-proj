(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{149:function(t,s,e){"use strict";e.r(s);var n=e(0),a=Object(n.a)({},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),e("p",[t._v("There are two major parts of the system:")]),t._v(" "),t._m(2),t._v(" "),e("p",[t._v("Both utilize a plugin-based architecture.")]),t._v(" "),t._m(3),t._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/@vue/cli/lib/Creator.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("Creator"),e("OutboundLink")],1),t._v(" is the class created when invoking "),e("code",[t._v("vue create <app>")]),t._v(". Responsible for prompting for preferences, invoking generators and installing dependencies.")]),t._v(" "),t._m(4),t._v(" "),e("p",[e("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/@vue/cli-service/lib/Service.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("Service"),e("OutboundLink")],1),t._v(" is the class created when invoking "),e("code",[t._v("vue-cli-service <command> [...args]")]),t._v(". Responsible for managing the internal webpack configuration, and exposes commands for serving and building the project.")]),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),e("p",[t._v("A typical CLI plugin's folder structure looks like the following:")]),t._v(" "),t._m(7),t._m(8),t._v(" "),t._m(9),t._v(" "),t._m(10),t._v(" "),e("p",[t._v("In addition, "),e("code",[t._v("@vue/cli-service")]),t._v("'s "),e("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/@vue/cli-service/lib/commands",target:"_blank",rel:"noopener noreferrer"}},[t._v("built-in commands"),e("OutboundLink")],1),t._v(" and "),e("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/@vue/cli-service/lib/config",target:"_blank",rel:"noopener noreferrer"}},[t._v("config modules"),e("OutboundLink")],1),t._v(" are also all implemented as service plugins.")]),t._v(" "),e("p",[t._v("A service plugin should export a function which receives two arguments:")]),t._v(" "),e("ul",[e("li",[e("p",[t._v("A "),e("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/@vue/cli-service/lib/PluginAPI.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("PluginAPI"),e("OutboundLink")],1),t._v(" instance")])]),t._v(" "),t._m(11)]),t._v(" "),t._m(12),t._v(" "),t._m(13),t._m(14),t._v(" "),t._m(15),t._v(" "),t._m(16),t._v(" "),t._m(17),e("p",[t._v("This is because the command's expected mode needs to be known before loading environment variables, which in turn needs to happen before loading user options / applying the plugins.")]),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),t._m(20),e("p",[t._v("Alternatively, a plugin can also obtain a fresh "),e("a",{attrs:{href:"https://github.com/mozilla-neutrino/webpack-chain",target:"_blank",rel:"noopener noreferrer"}},[t._v("chainable config"),e("OutboundLink")],1),t._v(" by calling "),e("code",[t._v("api.resolveChainableWebpackConfig()")]),t._v(":")]),t._v(" "),t._m(21),t._m(22),t._v(" "),e("p",[t._v("The exports from "),e("code",[t._v("vue.config.js")]),t._v(" will be "),e("a",{attrs:{href:"https://github.com/vuejs/vue-cli/blob/dev/packages/%40vue/cli-service/lib/options.js#L3",target:"_blank",rel:"noopener noreferrer"}},[t._v("validated against a schema"),e("OutboundLink")],1),t._v(" to avoid typos and wrong config values. However, a 3rd party plugin can still allow the user to configure its behavior via the "),e("code",[t._v("pluginOptions")]),t._v(" field. For example, with the following "),e("code",[t._v("vue.config.js")]),t._v(":")]),t._v(" "),t._m(23),t._m(24),t._v(" "),t._m(25),t._v(" "),t._m(26),t._v(" "),t._m(27),t._v(" "),e("p",[t._v("The "),e("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/@vue/cli/lib/GeneratorAPI.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("GeneratorAPI"),e("OutboundLink")],1),t._v(" allows a generator to inject additional dependencies or fields into "),e("code",[t._v("package.json")]),t._v(" and add files to the project.")]),t._v(" "),e("p",[t._v("A generator should export a function which receives three arguments:")]),t._v(" "),t._m(28),t._v(" "),t._m(29),t._v(" "),t._m(30),t._m(31),t._v(" "),e("p",[t._v("When you call "),e("code",[t._v("api.render('./template')")]),t._v(", the generator will render files in "),e("code",[t._v("./template")]),t._v(" (resolved relative to the generator file) with "),e("a",{attrs:{href:"https://github.com/mde/ejs",target:"_blank",rel:"noopener noreferrer"}},[t._v("EJS"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("p",[t._v("In addition, you can inherit and replace parts of an existing template file (even from another package) using YAML front-matter:")]),t._v(" "),t._m(32),t._m(33),t._v(" "),t._m(34),t._m(35),t._v(" "),t._m(36),t._v(" "),t._m(37),e("p",[t._v("Consequently, this means that you also have to follow a special naming convention if you want to render file whose name actually begins with an underscore:")]),t._v(" "),t._m(38),t._m(39),t._v(" "),t._m(40),t._v(" "),e("p",[t._v("Only built-in plugins have the ability to customize the initial prompts when creating a new project, and the prompt modules are located "),e("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/@vue/cli/lib/promptModules",target:"_blank",rel:"noopener noreferrer"}},[t._v("inside the "),e("code",[t._v("@vue/cli")]),t._v(" package"),e("OutboundLink")],1),t._v(".")]),t._v(" "),e("p",[t._v("A prompt module should export a function that receives a "),e("a",{attrs:{href:"https://github.com/vuejs/vue-cli/tree/dev/packages/@vue/cli/lib/PromptModuleAPI.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("PromptModuleAPI"),e("OutboundLink")],1),t._v(" instance. The prompts are presented using "),e("a",{attrs:{href:"https://github.com/SBoudrias/Inquirer.js",target:"_blank",rel:"noopener noreferrer"}},[t._v("inquirer"),e("OutboundLink")],1),t._v(" under the hood:")]),t._v(" "),t._m(41),t._m(42),t._v(" "),e("p",[t._v("3rd party plugins are typically installed manually after a project is already created, and the user will initialize the plugin by calling "),e("code",[t._v("vue invoke")]),t._v(". If the plugin contains a "),e("code",[t._v("prompts.js")]),t._v(" in its root directory, it will be used during invocation. The file should export an array of "),e("a",{attrs:{href:"https://github.com/SBoudrias/Inquirer.js#question",target:"_blank",rel:"noopener noreferrer"}},[t._v("Questions"),e("OutboundLink")],1),t._v(" that will be handled by Inquirer.js. The resolved answers object will be passed to the plugin's generator as options.")]),t._v(" "),e("p",[t._v("Alternatively, the user can skip the prompts and directly initialize the plugin by passing options via the command line, e.g.:")]),t._v(" "),t._m(43),t._m(44),t._v(" "),t._m(45),t._v(" "),t._m(46),t._v(" "),t._m(47),t._v(" "),t._m(48),t._v(" "),t._m(49),t._v(" "),t._m(50)])},[function(){var t=this.$createElement,s=this._self._c||t;return s("h1",{attrs:{id:"plugin-development-guide"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#plugin-development-guide","aria-hidden":"true"}},[this._v("#")]),this._v(" Plugin Development Guide")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"core-concepts"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#core-concepts","aria-hidden":"true"}},[this._v("#")]),this._v(" Core Concepts")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[e("code",[t._v("@vue/cli")]),t._v(": globally installed, exposes the "),e("code",[t._v("vue create <app>")]),t._v(" command;")]),t._v(" "),e("li",[e("code",[t._v("@vue/cli-service")]),t._v(": locally installed, exposes the "),e("code",[t._v("vue-cli-service")]),t._v(" commands.")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"creator"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#creator","aria-hidden":"true"}},[this._v("#")]),this._v(" Creator")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"service"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#service","aria-hidden":"true"}},[this._v("#")]),this._v(" Service")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"cli-plugin"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#cli-plugin","aria-hidden":"true"}},[this._v("#")]),this._v(" CLI Plugin")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("p",[t._v("A CLI plugin is an npm package that can add additional features to a "),e("code",[t._v("@vue/cli")]),t._v(" project. It should always contain a "),e("a",{attrs:{href:"#service-plugin"}},[t._v("Service Plugin")]),t._v(" as its main export, and can optionally contain a "),e("a",{attrs:{href:"#generator"}},[t._v("Generator")]),t._v(" and a "),e("a",{attrs:{href:"#prompts-for-3rd-party-plugins"}},[t._v("Prompt File")]),t._v(".")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v(".\n├── README.md\n├── generator.js  # generator (optional)\n├── prompts.js    # prompts file (optional)\n├── index.js      # service plugin\n└── package.json\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"service-plugin"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#service-plugin","aria-hidden":"true"}},[this._v("#")]),this._v(" Service Plugin")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("Service plugins are loaded automatically when a Service instance is created - i.e. every time the "),s("code",[this._v("vue-cli-service")]),this._v(" command is invoked inside a project.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v('Note the concept of a "service plugin" we are discussing here is narrower than that of a "CLI plugin", which is published as an npm package. The former only refers to a module that will be loaded by '),s("code",[this._v("@vue/cli-service")]),this._v(" when it's initialized, and is usually a part of the latter.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("li",[s("p",[this._v("An object containing project local options specified in "),s("code",[this._v("vue.config.js")]),this._v(", or in the "),s("code",[this._v('"vue"')]),this._v(" field in "),s("code",[this._v("package.json")]),this._v(".")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("The API allows service plugins to extend/modify the internal webpack config for different environments and inject additional commands to "),s("code",[this._v("vue-cli-service")]),this._v(". Example:")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("module"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("api"),e("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" projectOptions"),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  api"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("chainWebpack")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("webpackConfig "),e("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{attrs:{class:"token comment"}},[t._v("// modify webpack config with webpack-chain")]),t._v("\n  "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  api"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("configureWebpack")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("webpackConfig "),e("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{attrs:{class:"token comment"}},[t._v("// modify webpack config")]),t._v("\n    "),e("span",{attrs:{class:"token comment"}},[t._v("// or return object to be merged with webpack-merge")]),t._v("\n  "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  api"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("registerCommand")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token string"}},[t._v("'test'")]),e("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args "),e("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{attrs:{class:"token comment"}},[t._v("// register `vue-cli-service test`")]),t._v("\n  "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"specifying-mode-for-commands"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#specifying-mode-for-commands","aria-hidden":"true"}},[this._v("#")]),this._v(" Specifying Mode for Commands")])},function(){var t=this.$createElement,s=this._self._c||t;return s("blockquote",[s("p",[this._v("Note: the way plugins set modes has been changed in beta.10.")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("If a plugin-registered command needs to run in a specific default mode,\nthe plugin needs to expose it via "),s("code",[this._v("module.exports.defaultModes")]),this._v(" in the form\nof "),s("code",[this._v("{ [commandName]: mode }")]),this._v(":")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("module"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" api "),e("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  api"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("registerCommand")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token string"}},[t._v("'build'")]),e("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{attrs:{class:"token comment"}},[t._v("// ...")]),t._v("\n  "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\nmodule"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("defaultModes "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  build"),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{attrs:{class:"token string"}},[t._v("'production'")]),t._v("\n"),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"resolving-webpack-config-in-plugins"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#resolving-webpack-config-in-plugins","aria-hidden":"true"}},[this._v("#")]),this._v(" Resolving Webpack Config in Plugins")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("A plugin can retrieve the resolved webpack config by calling "),s("code",[this._v("api.resolveWebpackConfig()")]),this._v(". Every call generates a fresh webpack config which can be further mutated as needed:")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("module"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" api "),e("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  api"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("registerCommand")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token string"}},[t._v("'my-build'")]),e("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args "),e("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" configA "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" api"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("resolveWebpackConfig")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n    "),e("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" configB "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" api"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("resolveWebpackConfig")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    "),e("span",{attrs:{class:"token comment"}},[t._v("// mutate configA and configB for different purposes...")]),t._v("\n  "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),e("span",{attrs:{class:"token comment"}},[t._v("// make sure to specify the default mode for correct env variables")]),t._v("\nmodule"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("defaultModes "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{attrs:{class:"token string"}},[t._v("'my-build'")]),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{attrs:{class:"token string"}},[t._v("'production'")]),t._v("\n"),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("api"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("registerCommand")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token string"}},[t._v("'my-build'")]),e("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" args "),e("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" configA "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" api"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("resolveChainableWebpackConfig")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),e("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" configB "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" api"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("resolveChainableWebpackConfig")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),e("span",{attrs:{class:"token comment"}},[t._v("// chain-modify configA and configB for different purposes...")]),t._v("\n\n  "),e("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" finalConfigA "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" configA"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("toConfig")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),e("span",{attrs:{class:"token keyword"}},[t._v("const")]),t._v(" finalConfigB "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" configB"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("toConfig")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"custom-options-for-3rd-party-plugins"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#custom-options-for-3rd-party-plugins","aria-hidden":"true"}},[this._v("#")]),this._v(" Custom Options for 3rd Party Plugins")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("module"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  pluginOptions"),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    foo"),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{attrs:{class:"token comment"}},[t._v("/* ... */")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("The 3rd party plugin can read "),s("code",[this._v("projectOptions.pluginOptions.foo")]),this._v(" to determine conditional configurations.")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"generator"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#generator","aria-hidden":"true"}},[this._v("#")]),this._v(" Generator")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("A CLI plugin published as a package can contain a "),s("code",[this._v("generator.js")]),this._v(" or "),s("code",[this._v("generator/index.js")]),this._v(" file. The generator inside a plugin will be invoked in two possible scenarios:")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ul",[s("li",[s("p",[this._v("During a project's initial creation, if the CLI plugin is installed as part of the project creation preset.")])]),this._v(" "),s("li",[s("p",[this._v("When the plugin is installed after project's creation and invoked individually via "),s("code",[this._v("vue invoke")]),this._v(".")])])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ol",[e("li",[e("p",[t._v("A "),e("code",[t._v("GeneratorAPI")]),t._v(" instance;")])]),t._v(" "),e("li",[e("p",[t._v("The generator options for this plugin. These options are resolved during the prompt phase of project creation, or loaded from a saved preset in "),e("code",[t._v("~/.vuerc")]),t._v(". For example, if the saved "),e("code",[t._v("~/.vuerc")]),t._v(" looks like this:")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{attrs:{class:"token property"}},[t._v('"presets"')]),t._v(" "),e("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{attrs:{class:"token property"}},[t._v('"foo"')]),e("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),e("span",{attrs:{class:"token property"}},[t._v('"plugins"')]),e("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),e("span",{attrs:{class:"token property"}},[t._v('"@vue/cli-plugin-foo"')]),e("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" "),e("span",{attrs:{class:"token property"}},[t._v('"option"')]),e("span",{attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{attrs:{class:"token string"}},[t._v('"bar"')]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n      "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("And if the user creates a project using the "),e("code",[t._v("foo")]),t._v(" preset, then the generator of "),e("code",[t._v("@vue/cli-plugin-foo")]),t._v(" will receive "),e("code",[t._v("{ option: 'bar' }")]),t._v(" as its second argument.")]),t._v(" "),e("p",[t._v("For a 3rd party plugin, the options will be resolved from the prompts or command line arguments when the user executes "),e("code",[t._v("vue invoke")]),t._v(" (see "),e("a",{attrs:{href:"#prompts-for-3rd-party-plugins"}},[t._v("Prompts for 3rd Party Plugins")]),t._v(").")])]),t._v(" "),e("li",[e("p",[t._v("The entire preset ("),e("code",[t._v("presets.foo")]),t._v(") will be passed as the third argument.")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[s("strong",[this._v("Example:")])])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("module"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("api"),e("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),e("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" rootOptions"),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{attrs:{class:"token comment"}},[t._v("// modify package.json fields")]),t._v("\n  api"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("extendPackage")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    scripts"),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      test"),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{attrs:{class:"token string"}},[t._v("'vue-cli-service test'")]),t._v("\n    "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),e("span",{attrs:{class:"token comment"}},[t._v("// copy and render all files in ./template with ejs")]),t._v("\n  api"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("render")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token string"}},[t._v("'./template'")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),e("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("foo"),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{attrs:{class:"token comment"}},[t._v("// conditionally generate files")]),t._v("\n  "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"generator-templating"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#generator-templating","aria-hidden":"true"}},[this._v("#")]),this._v(" Generator Templating")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-ejs extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("---\nextend: '@vue/cli-service/generator/template/src/App.vue'\nreplace: !!js/regexp /<script>[^]*?<\\/script>/\n---\n\n<script>\nexport default {\n  // Replace default script\n}\n<\/script>\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("It's also possible to do multiple replaces, although you will need to wrap your replace strings within "),s("code",[this._v("<%# REPLACE %>")]),this._v(" and "),s("code",[this._v("<%# END_REPLACE %>")]),this._v(" blocks:")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-ejs extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("---\nextend: '@vue/cli-service/generator/template/src/App.vue'\nreplace:\n  - !!js/regexp /Welcome to Your Vue\\.js App/\n  - !!js/regexp /<script>[^]*?<\\/script>/\n---\n\n<%# REPLACE %>\nReplace Welcome Message\n<%# END_REPLACE %>\n\n<%# REPLACE %>\n<script>\nexport default {\n  // Replace default script\n}\n<\/script>\n<%# END_REPLACE %>\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"filename-edge-cases"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#filename-edge-cases","aria-hidden":"true"}},[this._v("#")]),this._v(" Filename edge cases")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("If you want to render a template file that either begins with a dot (i.e. "),s("code",[this._v(".env")]),this._v(") you will have to follow a specific naming convention, since dotfiles are ignored when publishing your plugin to npm:")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("# dotfile templates have to use an underscore instead of the dot:\n\n/generator/template/_env\n\n# When calling api.render('./template'), this will be rendered in the project folder as:\n\n.env\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[this._v("# such templates have to use two underscores instead of the dot:\n\n/generator/template/__variables.scss\n\n# When calling api.render('./template'), this will be rendered in the project folder as:\n\n_variables.scss\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h3",{attrs:{id:"prompts"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#prompts","aria-hidden":"true"}},[this._v("#")]),this._v(" Prompts")])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"prompts-for-built-in-plugins"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#prompts-for-built-in-plugins","aria-hidden":"true"}},[this._v("#")]),this._v(" Prompts for Built-in Plugins")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("div",{staticClass:"language-js extra-class"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[t._v("module"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function-variable function"}},[t._v("exports")]),t._v(" "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" api "),e("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{attrs:{class:"token comment"}},[t._v("// a feature object should be a valid inquirer choice object")]),t._v("\n  api"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("injectFeature")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    name"),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{attrs:{class:"token string"}},[t._v("'Some great feature'")]),e("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    value"),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{attrs:{class:"token string"}},[t._v("'my-feature'")]),t._v("\n  "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),e("span",{attrs:{class:"token comment"}},[t._v("// injectPrompt expects a valid inquirer prompt object")]),t._v("\n  api"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("injectPrompt")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    name"),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{attrs:{class:"token string"}},[t._v("'someFlag'")]),e("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{attrs:{class:"token comment"}},[t._v("// make sure your prompt only shows up if user has picked your feature")]),t._v("\n    when"),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" answers "),e("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" answers"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("features"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("include")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token string"}},[t._v("'my-feature'")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    message"),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{attrs:{class:"token string"}},[t._v("'Do you want to turn on flag foo?'")]),e("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    type"),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),e("span",{attrs:{class:"token string"}},[t._v("'confirm'")]),t._v("\n  "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),e("span",{attrs:{class:"token comment"}},[t._v("// when all prompts are done, inject your plugin into the options that")]),t._v("\n  "),e("span",{attrs:{class:"token comment"}},[t._v("// will be passed on to Generators")]),t._v("\n  api"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("onPromptComplete")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("answers"),e("span",{attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" options"),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),t._v("answers"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("features"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{attrs:{class:"token function"}},[t._v("includes")]),e("span",{attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{attrs:{class:"token string"}},[t._v("'my-feature'")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      options"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("plugins"),e("span",{attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{attrs:{class:"token string"}},[t._v("'vue-cli-plugin-my-feature'")]),e("span",{attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        someFlag"),e("span",{attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" answers"),e("span",{attrs:{class:"token punctuation"}},[t._v(".")]),t._v("someFlag\n      "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),e("span",{attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h4",{attrs:{id:"prompts-for-3rd-party-plugins"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#prompts-for-3rd-party-plugins","aria-hidden":"true"}},[this._v("#")]),this._v(" Prompts for 3rd Party Plugins")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[this._v("vue invoke my-plugin --mode awesome\n")])])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"distributing-the-plugin"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#distributing-the-plugin","aria-hidden":"true"}},[this._v("#")]),this._v(" Distributing the Plugin")])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("For a CLI plugin to be usable by other developers, it must be published on npm following the name convention "),s("code",[this._v("vue-cli-plugin-<name>")]),this._v(". Following the name convention allows your plugin to be:")])},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ul",[e("li",[t._v("Discoverable by "),e("code",[t._v("@vue/cli-service")]),t._v(";")]),t._v(" "),e("li",[t._v("Discoverable by other developers via searching;")]),t._v(" "),e("li",[t._v("Installable via "),e("code",[t._v("vue add <name>")]),t._v(" or "),e("code",[t._v("vue invoke <name>")]),t._v(".")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("h2",{attrs:{id:"note-on-development-of-core-plugins"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#note-on-development-of-core-plugins","aria-hidden":"true"}},[this._v("#")]),this._v(" Note on Development of Core Plugins")])},function(){var t=this.$createElement,s=this._self._c||t;return s("div",{staticClass:"tip custom-block"},[s("p",{staticClass:"custom-block-title"},[this._v("Note")]),this._v(" "),s("p",[this._v("This section only applies if you are working on a built-in plugin inside the "),s("code",[this._v("vuejs/vue-cli")]),this._v(" repository itself.")])])},function(){var t=this.$createElement,s=this._self._c||t;return s("p",[this._v("A plugin with a generator that injects additional dependencies other than packages in this repo (e.g. "),s("code",[this._v("chai")]),this._v(" is injected by "),s("code",[this._v("@vue/cli-plugin-unit-mocha/generator/index.js")]),this._v(") should have those dependencies listed in its own "),s("code",[this._v("devDependencies")]),this._v(" field. This ensures that:")])},function(){var t=this.$createElement,s=this._self._c||t;return s("ol",[s("li",[s("p",[this._v("the package always exist in this repo's root "),s("code",[this._v("node_modules")]),this._v(" so that we don't have to reinstall them on every test.")])]),this._v(" "),s("li",[s("p",[s("code",[this._v("yarn.lock")]),this._v(" stays consistent so that CI can better use it for inferring caching behavior.")])])])}],!1,null,null,null);a.options.__file="plugin-dev.md";s.default=a.exports}}]);